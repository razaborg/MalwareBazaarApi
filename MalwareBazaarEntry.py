#!/usr/bin/env python3
import json

class MalwareBazaarEntry:
	def __init__(self, **kwargs):	
		self.properties = kwargs

	@property
	def sha256_hash(self):
		return self.properties['sha256_hash']
	@property
	def sha1_hash(self):
		return self.properties['sha1_hash']
	@property
	def md5_hash(self):
		return self.properties['md5_hash']
	@property
	def sha256_hash(self):
		return self.properties['sha256_hash']
	@property
	def first_seen(self):
		return self.properties['first_seen']
	@property
	def last_seen(self):
		return self.properties['last_seen']
	@property
	def file_name(self):
		return self.properties['file_name']
	@property
	def file_size(self):
		return self.properties['file_size']
	@property
	def file_type_mime(self):
		return self.properties['file_type_mime']
	@property
	def file_type(self):
		return self.properties['file_type']
	@property
	def reporter(self):
		return self.properties['reporter']
	@property
	def anonymous(self):
		return self.properties['anonymous']
	@property
	def signature(self):
		return self.properties['signature']
	@property
	def imphash(self):
		return self.properties['imphash']
	@property
	def tlsh(self):
		return self.properties['tlsh']
	@property
	def ssdeep(self):
		return self.properties['ssdeep']
	@property
	def tags(self):
		return self.properties['tags']
	@property
	def intelligence(self):
		return self.properties['intelligence']

	def __repr__(self, indent=False):
		out = 'MalwareBazaarEntry('
		if indent:
			out += '\n'
		for k,v in self.properties.items():
			if not indent:
				out += f'{k}={repr(v)}, '
			else:
				out += f'  {k}={repr(v)},\n'
		if not indent: out = out[:-2]		
		out += ')'
		return out

	def to_json(self):
		return json.dumps(self.properties)

	def __str__(self):
		return self.__repr__(indent=True)

