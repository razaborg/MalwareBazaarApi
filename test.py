import os 
from MalwareBazaarClient import MalwareBazaarClient

with open('api_key') as f:
	api_key = f.read(32)

api = MalwareBazaarClient(api_key)
'''
for item in api.get_recent():
	path = f'out/{item.sha256_hash}'
	try:
		os.mkdir(path)
	except:
		continue
	name = f'{item.file_name}.zip'
	print(f'- Downloading {name}...')
	api.download_file(sha256_hash=item.sha256_hash, dest=path, filename=name)
	with open(f'{path}/infos.txt', 'w') as f:
		f.write(str(item))
'''
#print(api.get_infos('b47087bd013a60ff82b5338d7ea3dd4d804f6a961e9820fd306b9c5630775ebf'))

for entry in api.get_siginfo('TrickBot'):
	print(entry)

