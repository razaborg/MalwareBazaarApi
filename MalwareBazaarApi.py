#!/usr/bin/env python3
import requests
import json

class MalwareBazaarApi:
	def __init__(self, api_key=''):
		assert(len(api_key)>0)
		self._api_key=api_key
		self._headers = { 'API-KEY': self._api_key }
		self._params = {}

	def get_recent(self, time):
		assert(isinstance(time, int))
		self._params['query'] = 'get_recent'
		self._params['selector'] = time
		print(self._request())

	def _request(self):
		assert(self._params)
		r = requests.post('https://mb-api.abuse.ch/api/v1/', data=self._params, timeout=15, headers=self._headers)
		assert(r.status_code == 200)
		r = r.json
		
		
		


if __name__ == '__main__':
	# the magic part ;-)
	with open('api_key') as f:
		api_key=f.readline()[:-1]

	mb = MalwareBazaarApi(api_key)
	mb.get_recent(100)
